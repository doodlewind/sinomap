var Sinomap=function(){"use strict";function t(t,n){var e=y*t*g,i=Math.max(Math.min(m,n),-m)*g;return i=y*Math.log(Math.tan(Math.PI/4+i/2)),[e,i]}function n(n){var e=[];return n.features.forEach(function(n){"Polygon"===n.geometry.type?n.geometry.coordinates.forEach(function(n){e=e.concat(n.map(function(n){return t(n[0],n[1])}))}):n.geometry.coordinates.forEach(function(n){n.forEach(function(n){e=e.concat(n.map(function(n){return t(n[0],n[1])}))})})}),e}function e(t){var n=t.reduce(function(t,n){return t[0]<n[0]?t:n})[0],e=t.reduce(function(t,n){return t[0]>n[0]?t:n})[0],i=t.reduce(function(t,n){return t[1]<n[1]?t:n})[1];return{w:e-n,h:t.reduce(function(t,n){return t[1]>n[1]?t:n})[1]-i,xMin:n,yMin:i}}function i(t,n){var e=v(t,2),i=e[0],r=e[1],o=v(n,2),a=o[0],u=o[1],c=i/r/(a/u)>1,f=c?a/i:u/r;return[c?0:(a-i*f)/2,c?(u-r*f)/2:0,f]}function r(t,r,o){var a=n(t),u=e(a),c=i([u.w,u.h],[r,o]),f=v(c,3),h=f[0],s=f[1],l=f[2];return{offsetX:h,offsetY:s,xMin:u.xMin,yMin:u.yMin,scale:l}}function o(n,e,i){return i.map(function(i){var r=t(i[0],i[1]),o=v(r,2),a=o[0],u=o[1];return[a-n,u-e]})}function a(){return"devicePixelRatio"in window&&window.devicePixelRatio>1?window.devicePixelRatio:1}function u(t,n){var e=document.createElement("canvas"),i=a();return e.width=t*i,e.height=n*i,e.style.width=t+"px",e.style.height=n+"px",e.getContext("2d").scale(i,i),e}function c(t){var n=this;t.addEventListener("mousemove",function(t){var e=n.mapCanvas.getBoundingClientRect(),i=t.clientX,r=t.clientY;n.mouseX=(i-e.left)*n.mapCanvas.width/e.width,n.mouseY=(r-e.top)*n.mapCanvas.height/e.height,n.update()})}function f(){var t=function(){return parseInt(255*Math.random()).toString(16)};return"#"+t()+t()+t()}function h(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=(e.width,e.height),r=e.xOff,a=e.yOff,u=e.xMin,c=e.yMin,h=e.scale,s=e.style,l=void 0===s?{}:s,d=o(u,c,n);t.fillStyle=f(),t.strokeStyle=l.borderColor;for(var v=0;v<d.length;v++){var y=[d[v][0],d[v][1]],m=y[0],g=y[1];0===v&&t.beginPath(),t.lineTo(m*h+r,i-g*h-a)}t.closePath(),t.fill(),t.stroke()}function s(t,n,e){var i="string"==typeof this.el?document.querySelector(this.el):this.el;if(!i)throw new Error("[Sinomap] Target element not found.");this.mapCanvas=u(this.width,this.height),this.ctx=this.mapCanvas.getContext("2d"),i.appendChild(this.mapCanvas),c.bind(this)(this.mapCanvas)}function l(){var t=this,n=r(this.area,this.width,this.height),e={width:this.width,height:this.height,style:this.style,xOff:n.offsetX,yOff:n.offsetY,xMin:n.xMin,yMin:n.yMin,scale:n.scale};return this.area.features.forEach(function(n){"Polygon"===n.geometry.type?n.geometry.coordinates.forEach(function(n){h(t.ctx,n,e)}):n.geometry.coordinates.forEach(function(n){n.forEach(function(n){h(t.ctx,n,e)})})}),this}function d(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var v=function(){function t(t,n){var e=[],i=!0,r=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(i=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&u.return&&u.return()}finally{if(r)throw o}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),y=6378137,m=85.0511287798,g=Math.PI/180,p=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}();return function(){function t(n){var e=this;return d(this,t),Object.keys(n).forEach(function(t){e[t]=n[t]}),this.init(),this.update(),this}return p(t,[{key:"init",value:function(){this.mouseX=0,this.mouseY=0,s.bind(this)()}},{key:"update",value:function(){l.bind(this)()}}]),t}()}();
