var Sinomap=function(){"use strict";function t(t,n){var e=y*t*g,r=Math.max(Math.min(v,n),-v)*g;return r=y*Math.log(Math.tan(Math.PI/4+r/2)),[e,r]}function n(n){var e=[];return n.features.forEach(function(n){"Polygon"===n.geometry.type?n.geometry.coordinates.forEach(function(n){e=e.concat(n.map(function(n){return t(n[0],n[1])}))}):n.geometry.coordinates.forEach(function(n){n.forEach(function(n){e=e.concat(n.map(function(n){return t(n[0],n[1])}))})})}),e}function e(t){var n=t.reduce(function(t,n){return t[0]<n[0]?t:n})[0],e=t.reduce(function(t,n){return t[0]>n[0]?t:n})[0],r=t.reduce(function(t,n){return t[1]<n[1]?t:n})[1];return{w:e-n,h:t.reduce(function(t,n){return t[1]>n[1]?t:n})[1]-r,xMin:n,yMin:r}}function r(t,n){var e=l(t,2),r=e[0],i=e[1],o=l(n,2),a=o[0],h=o[1],c=r/i/(a/h)>1,u=c?a/r:h/i;return[c?0:(a-r*u)/2,c?(h-i*u)/2:0,u]}function i(t,i,o){var a=n(t),h=e(a),c=r([h.w,h.h],[i,o]),u=l(c,3),f=u[0],d=u[1],s=u[2];return{offsetX:f,offsetY:d,xMin:h.xMin,yMin:h.yMin,scale:s}}function o(n,e,r){return r.map(function(r){var i=t(r[0],r[1]),o=l(i,2),a=o[0],h=o[1];return[a-n,h-e]})}function a(){return"devicePixelRatio"in window&&window.devicePixelRatio>1?window.devicePixelRatio:1}function h(t,n){var e=document.createElement("canvas"),r=a();return e.width=t*r,e.height=n*r,e.style.width=t+"px",e.style.height=n+"px",e.getContext("2d").scale(r,r),e}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.el,e=void 0===n?"#map":n,r=t.width,i=void 0===r?1e3:r,o=t.height,a=void 0===o?600:o,c=document.querySelector(e),u=h(i,a);return c.appendChild(u),u}function u(){return"#"+[parseInt(1e4*Math.random())%256,parseInt(1e4*Math.random())%256,parseInt(1e4*Math.random())%256].map(function(t){return t.toString(16)}).join("")}function f(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(e.width,e.height),i=e.xOff,a=e.yOff,h=e.xMin,c=e.yMin,u=e.scale,f=e.style,d=void 0===f?{}:f,s=o(h,c,n);t.fillStyle=d.color,t.strokeStyle=d.borderColor;for(var l=0;l<s.length;l++){var y=[s[l][0],s[l][1]],v=y[0],g=y[1];0===l&&t.beginPath(),t.lineTo(v*u+i,r-g*u-a)}t.closePath(),t.fill(),t.stroke()}function d(){var t=c({width:this.width,height:this.height}),n=t.getContext("2d"),e=i(this.area,this.width,this.height),r={width:this.width,height:this.height,style:this.style,xOff:e.offsetX,yOff:e.offsetY,xMin:e.xMin,yMin:e.yMin,scale:e.scale};return this.area.features.forEach(function(t){r.color=u(),"Polygon"===t.geometry.type?t.geometry.coordinates.forEach(function(t){f(n,t,r)}):t.geometry.coordinates.forEach(function(t){t.forEach(function(t){f(n,t,r)})})}),this}function s(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var l=function(){function t(t,n){var e=[],r=!0,i=!1,o=void 0;try{for(var a,h=t[Symbol.iterator]();!(r=(a=h.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&h.return&&h.return()}finally{if(i)throw o}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),y=6378137,v=85.0511287798,g=Math.PI/180,w=function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n.width,r=void 0===e?1e3:e,i=n.height,o=void 0===i?600:i,a=n.area,h=void 0===a?null:a,c=n.style,u=void 0===c?{}:c;s(this,t),this.width=r,this.height=o,this.style=u,this.area=h,this.renderMap=d,this.renderMap()};return"undefined"!=typeof module&&(window.Sinomap=w),w}();
