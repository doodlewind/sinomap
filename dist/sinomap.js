var Sinomap=function(){"use strict";function t(t,n){var e=l*t*v,i=Math.max(Math.min(y,n),-y)*v;return i=l*Math.log(Math.tan(Math.PI/4+i/2)),[e,i]}function n(n){var e=[];return n.features.forEach(function(n){"Polygon"===n.geometry.type?n.geometry.coordinates.forEach(function(n){e=e.concat(n.map(function(n){return t(n[0],n[1])}))}):n.geometry.coordinates.forEach(function(n){n.forEach(function(n){e=e.concat(n.map(function(n){return t(n[0],n[1])}))})})}),e}function e(t){var n=t.reduce(function(t,n){return t[0]<n[0]?t:n})[0],e=t.reduce(function(t,n){return t[0]>n[0]?t:n})[0],i=t.reduce(function(t,n){return t[1]<n[1]?t:n})[1];return{w:e-n,h:t.reduce(function(t,n){return t[1]>n[1]?t:n})[1]-i,xMin:n,yMin:i}}function i(t,n){var e=s(t,2),i=e[0],r=e[1],o=s(n,2),a=o[0],h=o[1],c=i/r/(a/h)>1,u=c?a/i:h/r;return[c?0:(a-i*u)/2,c?(h-r*u)/2:0,u]}function r(t,r,o){var a=n(t),h=e(a),c=i([h.w,h.h],[r,o]),u=s(c,3),f=u[0],d=u[1],l=u[2];return{offsetX:f,offsetY:d,xMin:h.xMin,yMin:h.yMin,scale:l}}function o(n,e,i){return i.map(function(i){var r=t(i[0],i[1]),o=s(r,2),a=o[0],h=o[1];return[a-n,h-e]})}function a(){return"devicePixelRatio"in window&&window.devicePixelRatio>1?window.devicePixelRatio:1}function h(t,n){var e=document.createElement("canvas"),i=a();return e.width=t*i,e.height=n*i,e.style.width=t+"px",e.style.height=n+"px",e.getContext("2d").scale(i,i),e}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.el,e=void 0===n?"#map":n,i=t.width,r=void 0===i?1e3:i,o=t.height,a=void 0===o?600:o,c=document.querySelector(e),u=h(r,a);return c.appendChild(u),u}function u(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=(e.width,e.height),r=e.xOff,a=e.yOff,h=e.xMin,c=e.yMin,u=e.scale,f=e.style,d=void 0===f?{}:f,s=o(h,c,n);t.fillStyle=d.color,t.strokeStyle=d.borderColor;for(var l=0;l<s.length;l++){var y=[s[l][0],s[l][1]],v=y[0],g=y[1];0===l&&t.beginPath(),t.lineTo(v*u+r,i-g*u-a)}t.closePath(),t.fill(),t.stroke()}function f(){var t=c({width:this.width,height:this.height}),n=t.getContext("2d"),e=r(this.area,this.width,this.height),i={width:this.width,height:this.height,style:this.style,xOff:e.offsetX,yOff:e.offsetY,xMin:e.xMin,yMin:e.yMin,scale:e.scale};return this.area.features.forEach(function(t){"Polygon"===t.geometry.type?t.geometry.coordinates.forEach(function(t){u(n,t,i)}):t.geometry.coordinates.forEach(function(t){t.forEach(function(t){u(n,t,i)})})}),this}function d(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var s=function(){function t(t,n){var e=[],i=!0,r=!1,o=void 0;try{for(var a,h=t[Symbol.iterator]();!(i=(a=h.next()).done)&&(e.push(a.value),!n||e.length!==n);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&h.return&&h.return()}finally{if(r)throw o}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=6378137,y=85.0511287798,v=Math.PI/180,g=function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n.width,i=void 0===e?1e3:e,r=n.height,o=void 0===r?600:r,a=n.area,h=void 0===a?null:a,c=n.style,u=void 0===c?{}:c;d(this,t),this.width=i,this.height=o,this.style=u,this.area=h,this.renderMap=f,this.renderMap()};return"undefined"!=typeof module&&(window.Sinomap=g),g}();
